js:
/* äºŒçº§æ–°æ ·å¼&åˆ†é¡µ å°è£…_byé¡º_v2022.4.29 */

var åˆ†é¡µä¸´ç•Œå€¼ = 10;
var d = [];
//å—…æ¢ (æ„Ÿè°¢é¦™ä½¬æä¾›é€šå…)
if (å—…æ¢ == 'å…å—…') {
	try {
		eval(JSON.parse(fetch('hiker://page/lazy')).rule);
	} catch (e) {
		var lazy = $('').lazyRule(() => {
			requireCache('https://code.aliyun.com/lzk23559/PublicRule/raw/master/x5rule.js', 24);
			return x5rule(input, input);
		})
	}
} else if (å—…æ¢ == 'é€šå…') {
	var lazy = $('').lazyRule(() => {
		requireCache('https://code.aliyun.com/lzk23559/PublicRule/raw/master/x5rule.js', 24);
		return x5rule(input, input);
	})
} else if (å—…æ¢ == 'æ–­æ’') {
	require('https://gitea.com/AI957/Hiker/raw/m/v/Route.js');
}
//è°ƒç”¨x5äºŒçº§æ–°æ ·å¼
require('https://raw.githubusercontent.com/YeWBin55555/ZIYONG/main/byTianyiErjimuban');
//æ‰§è¡Œx5æ ·å¼
if (x5æ ·å¼ == 'å¼€') {
	header(d, {
	å¤§å­—: title_big,
	ç‰‡å: title,
	å›¾ç‰‡: des_pic,
	æè¿°: des_text,
})
} else if (è·é¡¶ == 'å¼€') {
	for (let i = 0; i < 80; i++) {
		d.push({
			col_type: "blank_block"
		})
	}
}
if (çº¿è·¯æ ·å¼ == 'scroll_button') {
	for (let i = 0; i < 20; i++) {
		d.push({
			col_type: "blank_block"
		})
	}
}
if (çº¿è·¯æ ·å¼ == 'flex_button') {
	for (let i = 0; i < 10; i++) {
		d.push({
			col_type: "blank_block"
		})
	}
}
//çº¿è·¯å›¾æ ‡åˆ—è¡¨
requireCache("http://82.156.222.77/img/æ¨¡ç³ŠåŒ¹é…å›¾æ ‡åˆ—è¡¨.js", 24);
function çº¿è·¯å›¾æ ‡(çº¿è·¯å) {
	var tab_s = Object.keys(obj);
	var tab_sn = çº¿è·¯å.replace(/\d+|ä¸€|äºŒ|ä¸‰|â‘ |â‘¡|â‘¢|è§†é¢‘|èµ„æº|åˆ‡ç‰‡/g, '').toUpperCase()
	for(let l in tab_s) {
		var tss = new RegExp(tab_sn).test(tab_s[l].toUpperCase());
		if(tss == true) {
			var tab_name=tab_s[l];
		}
	}
	tab_img = obj[tab_name];
	return tab_img
};

function æ‰€æœ‰çº¿è·¯(tabs, taburl) {
	for (var i in tabs) {
		var tabname = tabs[i];
		var tab_img = '';
		if (çº¿è·¯æ ·å¼ == 'icon_small_3') {
			var print = tabname == getMyVar('å½“å‰çº¿è·¯å') ? "<font color='" + Color + "'>" + tabname + "</font>" : tabname;
		   tab_img = çº¿è·¯å›¾æ ‡(tabname);
		} else {
			var print = tabname == getMyVar('å½“å‰çº¿è·¯å') ? "â€œâ€œâ€â€<font color='" + Color + "'>" + tabname + "</font>" : tabname
		}
		if(tabs.length > 1){
			d.push({
				title: print,
				img: tab_img || "https://lanmeiguojiang.com/tubiao/movie/137.svg",
				col_type: çº¿è·¯æ ·å¼,
				url: $("#noLoading#").lazyRule((tabname, taburl, i) => {
					putMyVar('å½“å‰çº¿è·¯å', tabname);
					putMyVar(taburl, i)
					refreshPage(false);
					return 'hiker://empty'
				}, tabname, taburl, i)
			})
		}
	}
	
	//æ˜¾ç¤ºæ­£ååˆ‡æ¢æŒ‰é’®
	var icon_s = 'http://82.156.222.77/weisyr/icon/';
	if (getMyVar('é€‰é›†æ’åº') == 'æ­£åº') {
		var avatar = icon_s + 'æ­£åº.svg';
		var sx = '<font color = "' + Color + '"><b>â†¿</b></font>' + '<font color = "grey"><b>â‡‚</b></font>';
	} else {
		var avatar = icon_s + 'ååº.svg';
		var sx = '<font color = "grey"><b>â†¿</b></font>' + '<font color = "' + Color + '"><b>â‡‚</b></font>';
	}
	var img = '';
	if (çº¿è·¯æ ·å¼ == 'icon_small_3') {
		sx='';
		img = avatar;
	} else if (çº¿è·¯æ ·å¼ != 'icon_small_3') {
		img = çº¿è·¯å›¾æ ‡(tabs[é€‰ä¸­çº¿è·¯]) || "http://82.156.222.77/img/list.svg";
	}
	var url = `@lazyRule=.js:if(getMyVar('é€‰é›†æ’åº')=='æ­£åº'){putMyVar('é€‰é›†æ’åº', 'ååº');}else{putMyVar('é€‰é›†æ’åº', 'æ­£åº')};refreshPage(false);hideLoading();'hiker://empty'`;
	if (lists[é€‰ä¸­çº¿è·¯].length == 1) {
		sx='';
		url = 'hiker://empty';
		img = çº¿è·¯å›¾æ ‡(tabs[é€‰ä¸­çº¿è·¯]) || "http://82.156.222.77/img/list.svg";
	}
	d.push({
		title: "<b><font color='" + Color + "'>" + tabs[é€‰ä¸­çº¿è·¯] + "</font></b>" + "<small><font color='grey'>" + '\t\t-- å…± ' + lists[é€‰ä¸­çº¿è·¯].length + ' é›†' +"</font></small>" + ' ' + sx,
		url: url,
		col_type: 'avatar',
		img: img
	})
	d.push({
		col_type: 'line'
	});
	for (let i = 0; i < 5; i++) {
		d.push({
			col_type: "blank_block"
		})
	}
};

function æŠ¥é”™(tips) {
	for (let i = 0; i < 10; i++) {
		d.push({
			col_type: "blank_block"
		})
	}
	d.push({
		title: "â€œâ€œâ€â€ <small><font color='grey'>" + "â€”â€”   "+ tips +"   â€”â€”" + "</font></small>",
		col_type: "text_center_1",
		url: 'hiker://empty',
		extra: {
			lineVisible: false
		}
	})
};

function é€‰é›†åˆ—è¡¨(lists, index) {
	//æ¸…é™¤å˜é‡
	addListener('onClose', $.toString(() => {
		clearMyVar('å½“å‰çº¿è·¯å');
		clearMyVar('åˆ†é›†èµ·');
		clearMyVar('åˆ†é›†ç»ˆ');
	}))
	var list = lists[index];
	// å°†ååºå½’æ­£
	try {
		if (pdfh(list[0], "a&&Text").match(/(\d+)/)[0] > pdfh(list.slice(-1)[0], "a&&Text").match(/(\d+)/)[0]) list.reverse()
	} catch (e) {}
	
	for (let i = 0; i < 5; i++) {
		d.push({
			col_type: "blank_block"
		})
	}

	function é€‰é›†() {
		var jm = pdfh(list[i], 'a&&Text').replace(/ç¬¬|é›†|è¯|æœŸ/g, '').replace(/é¢„å‘Š/g, 'ğŸ“¢');
		var url = parseDom(list[i], 'a&&href');
		if (å—…æ¢ == 'æ–­æ’') {
			url = playerParse(url)
		} else {
			url = url + lazy;
		}
		if (list.length < 5) {
			var col = 'text_2'
		} else {
			var col = jm.length > 5 ? 'text_2' : 'text_4'
		}
		d.push({
			title: jm,
			url: url,
			col_type: col,
			extra: {
				id: url,
				blockRules: ['.css', '.gif', '.jpg', '.jpeg', '.png', '.ico', '.svg', 'cnzz', 'google', 'xn--*:*', 'hm.baidu.com', '/ads/*.js', '.m3u8', '.mp4']
			}
		});
	}
	try { // å¼€å§‹é¡µç åˆ†åŒº é€‰é›†ï¼è®¾å®šé›†æ•°10ä¸ªä»¥ä¸Šæ‰å¯ç”¨é€‰é›†åˆ†é¡µ
		var é€‰é›†æ•°ç»„ = list;
		if (é€‰é›†æ•°ç»„.length > (page_number + åˆ†é¡µä¸´ç•Œå€¼)) {
			//æ‰€æœ‰é›†æ•°é™¤ä»¥æ¯é¡µé›†æ•°ï¼Œæœ‰ä½™è¿›æ•´
			var total = Math.ceil(é€‰é›†æ•°ç»„.length / page_number);
			var catalogue = []
			for (let i = 0; i < total; i++) {
				catalogue += i * page_number + ',';
				catalogue = catalogue.split(',');
			}
			for (let i = 0; i < 8; i++) {
				d.push({
					col_type: "blank_block"
				})
			}
			//è¾“å‡ºåˆ†é¡µæŒ‰é’®
			var æŒ‰é’® = [];
			for (var i = 0; i < catalogue.length - 1; i++) {
				var total1 = parseInt(catalogue[i]) + 1;
				var total2 = parseInt(catalogue[i + 1]);
				if (i == (catalogue.length - 2)) var total2 = é€‰é›†æ•°ç»„.length;

				d.push({
					title: star == total1 ? "â€œâ€œâ€â€<font color='" + Color + "'>" + total1 + "-" + total2 + "</font>" : total1 + "-" + total2,
					url: $("#noLoading#").lazyRule((total1, total2) => {
						putMyVar('åˆ†é›†èµ·', total1);
						putMyVar('åˆ†é›†ç»ˆ', total2);
						refreshPage(false);
						return 'hiker://empty'
					}, total1, total2),
					col_type: 'scroll_button'
				});
				var total0= total1;
				if (star == total1) total0= 'ğŸ”»'+total1
				æŒ‰é’®.push(total0 + '-' + total2)
			}
			if (getMyVar('é€‰é›†æ’åº') == 'æ­£åº') {
				for (var i = end - 1; i >= star - 1; i--) {
					é€‰é›†()
				}
			} else {
				for (var i = star - 1; i < end; i++) {
					é€‰é›†()
				}
			}
			//åº•éƒ¨é¡µç 
			d.push({
				col_type: "line"
			})
			var yema = Math.ceil(end / page_number);
			d.push({
				title: "â€œâ€œâ€â€ <small><small><font color='grey'>" + yema + ' / ' + total + "</font> </small></small>",
				col_type: "text_center_1",
				url: $("#noLoading#").lazyRule((æŒ‰é’®) => $(æŒ‰é’®, 3).select(_ => {
					putMyVar('åˆ†é›†èµ·', input.split('-')[0]);
					putMyVar('åˆ†é›†ç»ˆ', input.split('-')[1]);
					refreshPage(false);
					return "toast://ä½ é€‰æ‹©äº†" + input;
				}), æŒ‰é’®),
				extra: {
					lineVisible: false
				}
			})
			//åº•éƒ¨æ“ä½œæŒ‰é’®
			if (åº•éƒ¨æ¢é¡µ == 'å¼€') {
				d.push({
					//title: 'é¦–é¡µ',
					title: "â€œâ€œâ€â€ <small>é¦–é¡µ</small>",
					url: $("#noLoading#").lazyRule((page_number) => {
						putMyVar('åˆ†é›†èµ·', '1');
						putMyVar('åˆ†é›†ç»ˆ', page_number);
						refreshPage(false);
						return 'hiker://empty'
					}, page_number),
					col_type: 'text_4'
				});
				d.push({
					title:  "â€œâ€œâ€â€ <small>ä¸Šä¸€é¡µ</small>",
					url: $("#noLoading#").lazyRule((star, end, page_number, total, é€‰é›†æ•°ç»„) => {
						var s = parseInt(star) - page_number;
						var e = parseInt(end) - page_number;
						if (end = é€‰é›†æ•°ç»„.length) var e = s + page_number - 1;
						if (s < 1) {
							var s = 1;
							var e = page_number;
						}
						if (s > 0) {
							putMyVar('åˆ†é›†èµ·', s);
							putMyVar('åˆ†é›†ç»ˆ', e);
							refreshPage(false);
						}
						return 'hiker://empty'
					}, star, end, page_number, total, é€‰é›†æ•°ç»„),
					col_type: 'text_4'
				});
				d.push({
					title:  "â€œâ€œâ€â€ <small>ä¸‹ä¸€é¡µ</small>",
					url: $("#noLoading#").lazyRule((star, end, page_number, total, é€‰é›†æ•°ç»„) => {
						var s = parseInt(star) + page_number;
						var e = parseInt(end) + page_number;
						if (e > é€‰é›†æ•°ç»„.length) {
							var s = (total - 1) * page_number + 1;
							var e = é€‰é›†æ•°ç»„.length;
						}
						putMyVar('åˆ†é›†èµ·', s);
						putMyVar('åˆ†é›†ç»ˆ', e);
						refreshPage(false);
						return 'hiker://empty'
					}, star, end, page_number, total, é€‰é›†æ•°ç»„),
					col_type: 'text_4'
				});
				d.push({
					title:  "â€œâ€œâ€â€ <small>å°¾é¡µ</small>",
					url: $("#noLoading#").lazyRule((page_number, total, é€‰é›†æ•°ç»„) => {
						var s = (total - 1) * page_number + 1;
						putMyVar('åˆ†é›†èµ·', s);
						putMyVar('åˆ†é›†ç»ˆ', é€‰é›†æ•°ç»„.length);
						refreshPage(false);
						return 'hiker://empty'
					}, page_number, total, é€‰é›†æ•°ç»„),
					col_type: 'text_4'
				});
			}
		} // ç»“æŸé€‰é›†åˆ†é¡µ
		else {
			if (getMyVar('é€‰é›†æ’åº') == 'æ­£åº') {
				for (var i = list.length - 1; i >= 0; i--) {
					é€‰é›†()
				}
			} else {
				for (var i = 0; i < list.length; i++) {
					é€‰é›†()
				}
			}
		}
	} catch (e) {
		æŠ¥é”™('é€‰é›†ä¸ºç©º')
	}
	// åº•éƒ¨ç•™ç©º
	d.push({
		title: '\n',
		url: 'hiker://empty',
		col_type: 'rich_text'
	});
} //ç»“æŸé€‰é›†åˆ—è¡¨

//ğŸ¤¡åˆ†é¡µå¼€å…³è®¾ç½®
var page_number = æ¯é¡µé›†æ•°;
let åº•éƒ¨æ¢é¡µ = åº•éƒ¨æŒ‰é’®; //åº•éƒ¨æ§åˆ¶æŒ‰é’®
try { //è‡³å°‘ä¸¤æ¡çº¿è·¯ï¼Œæˆ–è€…å¯ç”¨åˆ†é¡µæ‰è¢«è®°å½•
	if (tabs.length > 1 || lists[0].length > (page_number + åˆ†é¡µä¸´ç•Œå€¼)) {
		function è®°å½•è¶³è¿¹(çº¿è·¯, é¡µé¢) {
			var history = JSON.parse(request('hiker://files//cache/é¡º_è®°å½•çº¿è·¯å’Œé¡µç .json') || '[]');
			var t = history.findIndex(item => item.å°ç¨‹åº == MY_RULE.title);
			if (t == -1) {
				t = history.length;
				history.push({
					å°ç¨‹åº: MY_RULE.title,
					è¶³è¿¹: []
				})
			}
			var y = history[t].è¶³è¿¹.findIndex(item => item.url == MY_URL);
			if (y == -1) {
				history[t].è¶³è¿¹.push({
					url: MY_URL,
					tab: çº¿è·¯,
					index: é¡µé¢
				});
			} else {
				history[t].è¶³è¿¹[y].tab = çº¿è·¯;
				history[t].è¶³è¿¹[y].index = é¡µé¢;
			}
			if (history[t].è¶³è¿¹.length >= 999) {
				history[t].è¶³è¿¹.splice(0, 1);
			}
			writeFile("hiker://files//cache/é¡º_è®°å½•çº¿è·¯å’Œé¡µç .json", JSON.stringify(history, null, 2));
		}
		//è¯»å†™è¶³è¿¹
		var historyA = JSON.parse(fetch('hiker://files//cache/é¡º_è®°å½•çº¿è·¯å’Œé¡µç .json') || '[]');
		var historyIT = historyA.find(item => item.å°ç¨‹åº == MY_RULE.title);
		if (historyIT) { //åˆ¤æ–­å½“å‰å°ç¨‹åº
			historyIT = historyIT.è¶³è¿¹.find(it => it.url == MY_URL);
			if (historyIT) { //åˆ¤æ–­å½“å‰ç‰‡å­è®°å½•
				var itemA = historyIT.tab;
				var itemP = historyIT.index;
				if (getMyVar('åˆ†é›†èµ·') == "") {
					var star = itemP.split('-')[0];
					var end = itemP.split('-')[1];
					if (itemP == 'undefined-undefined' || itemP == '-') {
						star = '1';
						end = page_number;
					}
					if (!itemA) var é€‰ä¸­çº¿è·¯ = '0';
				}
				if (getMyVar('å½“å‰çº¿è·¯å') == "") {
					var é€‰ä¸­çº¿è·¯ = itemA || '0'
				}
				if (getMyVar('åˆ†é›†èµ·') != "") {
					var star = getMyVar('åˆ†é›†èµ·');
					var end = getMyVar('åˆ†é›†ç»ˆ');
					var é€‰ä¸­çº¿è·¯ = itemA || '0';
					è®°å½•è¶³è¿¹(é€‰ä¸­çº¿è·¯, star + '-' + end)
				}
				if (getMyVar('å½“å‰çº¿è·¯å') != "") {
					var star = getMyVar('åˆ†é›†èµ·', '1');
					var end = getMyVar('åˆ†é›†ç»ˆ', JSON.stringify(page_number));
					var é€‰ä¸­çº¿è·¯ = getMyVar(MY_URL);
					è®°å½•è¶³è¿¹(é€‰ä¸­çº¿è·¯, star + '-' + end)
				}
			} else { //å¦‚æœç‰‡å­æ²¡æœ‰è®°å½•
				var star = 1;
				var end = page_number;
				var é€‰ä¸­çº¿è·¯ = '0';
				è®°å½•è¶³è¿¹('0', "1" + '-' + page_number)
			}
		} else { //å¦‚æœå°ç¨‹åºæ²¡æœ‰è®°å½•
			var star = 1;
			var end = page_number;
			var é€‰ä¸­çº¿è·¯ = '0';
			è®°å½•è¶³è¿¹('0', "1" + '-' + page_number)
		}
	} else {
		var é€‰ä¸­çº¿è·¯ = '0';
	}
} catch (e) {
	æŠ¥é”™('è¶³è¿¹å‡ºé”™')
}
try{
	æ‰€æœ‰çº¿è·¯(tabs, MY_URL);
} catch (e) {
	æŠ¥é”™('çº¿è·¯ä¸ºç©º')
}
é€‰é›†åˆ—è¡¨(lists, é€‰ä¸­çº¿è·¯);
setResult(d);
